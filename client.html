<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Meu primeiro jogo</title>
    <style>
        #screen{
            border: 10px solid black;
            width: 400px;
            height: 400px;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            image-rendering: -moz-crisp-edges;
        }
    </style>
</head>
<body>
    <canvas id="screen" width="10px" height="10px"></canvas>

    <script>

        const screen = document.getElementById('screen')
        const context = screen.getContext('2d')
        document.addEventListener('keydown', createEventListener)


        //regras de negócio
        function movePlayer(command) {
            const player = state.players[command.player]
            const keyPressed = command.keyPressed

            if (keyPressed === "ArrowUp" && player.y > 0) {
                player.y --
            }

            if (keyPressed === "ArrowDown" && player.y < screen.height) {
                player.y ++
            }

            if (keyPressed === "ArrowLeft" && player.x > 0) {
                player.x --
            }

            if (keyPressed === "ArrowRight" && player.x < screen.width) {
                player.x ++
            }
        }

        //obter todos os inputs necessários no jogo
        function createEventListener(event){
            const keyPressed = event.key
            
            const state = {
                player: 'player1',
                keyPressed
            }

            movePlayer(state)

        }

        

        //renderizar o jogo para o usuário
        const state = {
            players: {
                'player1': { x:1, y:1 },
                'player2': { x:5, y:7 }
            },

            fruits: {
                'fruit1': { x:3, y:1 }
            }
        }

        renderGame()
        
        function renderGame(){

            context.clearRect(0, 0, 10, 10)

            for (const playerId in state.players) {
                const player = state.players[playerId]
                context.fillStyle = 'black'
                context.fillRect(player.x, player.y, 1, 1)
            }

            for (const fruitId in state.fruits) {
                const fruit = state.fruits[fruitId]
                context.fillStyle = 'green'
                context.fillRect(fruit.x, fruit.y, 1, 1)
            }

            requestAnimationFrame(renderGame)

        }

        

        

        
    </script>

</body>
</html>